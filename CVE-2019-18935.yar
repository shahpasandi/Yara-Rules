/*
   YARA Rule Set
   Author: https://twitter.com/M_Shahpasandi
   Date: 2022-04-25
   Identifier: dll
   Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935
*/

/* Rule Set ----------------------------------------------------------------- */

rule CVE_2019_18935 {
   meta:
      description = "dll - file 1650037817.120003.dll"
      author = "https://twitter.com/M_Shahpasandi"
      reference = "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935"
      date = "2022-04-25"

   strings:
      $s1 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s2 = "sleep-2022041520195774-amd64.dll" fullword ascii
      $s3 = " Type Descriptor'" fullword ascii
      $s4 = "operator co_await" fullword ascii
      $s5 = "operator<=>" fullword ascii
      $s6 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide
      $s7 = " Class Hierarchy Descriptor'" fullword ascii
      $s8 = " Base Class Descriptor at (" fullword ascii
      $s9 = " Complete Object Locator'" fullword ascii
      $s10 = "__swift_1" fullword ascii
      $s11 = ".rdata$voltmd" fullword ascii
      $s12 = " delete[]" fullword ascii
      $s13 = "sleep-2022041520195774-amd64" fullword ascii
      $s14 = "igfxsle_11224074_amd64.dll" fullword ascii 
      $s15 = "__swift_2" fullword ascii
      $s16 = "api-ms-win-core-file-l1-2-2" fullword wide /* Goodware String - occured 1 times */
      $s17 = "u3HcH<H" fullword ascii /* Goodware String - occured 2 times */
      $s18 = "D$XD9x" fullword ascii /* Goodware String - occured 2 times */
      $s19 = " delete" fullword ascii
      $s20 = "System" fullword ascii /* Goodware String - occured 2567 times */
      $s21 = "H97u+A" fullword ascii
      

   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

